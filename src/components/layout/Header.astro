---
import "../../styles/global.css";
import Search from "@astrojs/starlight/components/Search.astro";

const navLinks = [
  { name: "Home", href: "/" },
  {
    name: "CIC Guide",
    href: "/cic-guide",
    dropdown: [
      { name: "Western Australia", href: "/wa-guide", active: true },
      { name: "Victoria", href: "#", active: false },
      { name: "New South Wales", href: "#", active: false },
      { name: "Queensland", href: "#", active: false },
      { name: "South Australia", href: "#", active: false },
      { name: "Tasmania", href: "#", active: false },
      { name: "Northern Territory", href: "#", active: false },
      { name: "ACT", href: "#", active: false },
    ],
  },
  { name: "Support Services", href: "/support-services" },
];
---

<nav
  id="custom-nav"
  class="sticky top-0 z-50 w-full border-b border-transparent bg-white/90 backdrop-blur-md transition-all duration-300"
>
  <div
    class="mx-auto flex h-16 max-w-[1400px] items-center justify-between px-6"
  >
    <a
      href="/"
      class="group flex items-center gap-2 text-black no-underline hover:text-black"
    >
      <div class="font-extrabold text-xl flex items-center">
        <img src="/book.png" alt="Book Logo" class="mr-2 h-8 w-auto" />
        CIC Handbook
      </div>
    </a>

    <div class="hidden md:flex gap-8 items-center h-full">
      {
        navLinks.map((link) =>
          link.dropdown ? (
            <div class="group relative flex h-full items-center">
              <button class="flex h-full cursor-pointer items-center gap-1 bg-transparent p-0 text-[0.95rem] font-medium text-gray-600 transition-colors group-hover:text-[#78081C] focus:outline-none">
                {link.name}
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="transition-transform group-hover:rotate-180"
                >
                  <path d="m6 9 6 6 6-6" />
                </svg>
              </button>

              <div class="absolute left-1/2 top-[calc(100%-0.5rem)] hidden w-56 -translate-x-1/2 pt-2 group-hover:block">
                <div class="overflow-hidden rounded-lg border border-gray-100 bg-white py-2 shadow-xl">
                  {link.dropdown.map((subItem) =>
                    subItem.active ? (
                      <a
                        href={subItem.href}
                        class="block px-4 py-2.5 text-sm font-medium text-gray-700 transition-colors hover:bg-gray-50 hover:text-[#78081C]"
                      >
                        {subItem.name}
                      </a>
                    ) : (
                      <div class="flex cursor-default items-center justify-between bg-gray-50/50 px-4 py-2.5 text-sm text-gray-400">
                        <span>{subItem.name}</span>
                        <span class="rounded bg-gray-100 px-1.5 py-0.5 text-[0.65rem] font-bold uppercase tracking-wider text-gray-500">
                          Soon
                        </span>
                      </div>
                    )
                  )}
                </div>
              </div>
            </div>
          ) : (
            <a
              href={link.href}
              class="flex h-full items-center text-[0.95rem] font-medium text-gray-600 no-underline transition-colors hover:text-[#78081C]"
            >
              {link.name}
            </a>
          )
        )
      }
    </div>

    <div class="flex items-center gap-3">
      <div class="flex items-center">
        <Search />
      </div>

      <a
        href="https://www.google.com.au"
        class="inline-flex h-10 items-center justify-center rounded-full border-2 border-[#78081c] bg-white px-4 py-2 text-sm font-bold text-[#78081c] no-underline transition hover:bg-[#78081c] hover:text-white"
      >
        Quick Exit
      </a>
    </div>
  </div>
</nav>

<script>
  const nav = document.getElementById("custom-nav");

  window.addEventListener("scroll", () => {
    if (window.scrollY > 20) {
      nav?.classList.add("bg-white", "border-gray-200", "shadow-sm");
      nav?.classList.remove("bg-white/90", "border-transparent");
    } else {
      nav?.classList.remove("bg-white", "border-gray-200", "shadow-sm");
      nav?.classList.add("bg-white/90", "border-transparent");
    }
  });
</script>


